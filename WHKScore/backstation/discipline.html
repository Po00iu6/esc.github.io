<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <link href="https://ys.mihoyo.com/main/favicon.ico" rel="icon" type="image/x-icon" />
    <link href="https://ys.mihoyo.com/main/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <meta
        content="https://fastcdn.mihoyo.com/static-resource-v2/2023/12/20/e04bc0be964b4fc7056bc1128b35f200_4546122273706382871.png"
        property="og:image" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>堕落记录</title>
    <!-- Exo thin font from Google -->
    <link href="https://fonts.googleapis.com/css?family=Exo:100" rel="stylesheet">
    <!-- 背景动画样式 -->
    <link rel="stylesheet" href="background-animation.css">
    <style>
        body {
            color: #C9D1D9;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        /* 音乐开关样式 */
        .music-toggle-container {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .music-label {
            font-size: 14px;
            color: #8B949E;
        }
        
        /* 生成月报按钮样式 */
        .report-button-container {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        
        .generate-report-btn {
            background-color: #58A6FF;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .generate-report-btn:hover {
            background-color: #316DCA;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #30363D;
            transition: .4s;
            border-radius: 20px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.toggle-slider {
            background-color: #58A6FF;
        }

        input:focus+.toggle-slider {
            box-shadow: 0 0 1px #58A6FF;
        }

        input:checked+.toggle-slider:before {
            transform: translateX(20px);
        }

        .container {
            max-width: 1200px;
            width: 100%;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #58A6FF;
        }

        .streak-info {
            text-align: center;
            margin-bottom: 20px;
            font-size: 18px;
        }

        .streak-count {
            color: #3FB950;
            font-weight: bold;
            font-size: 24px;
        }

        .total-count {
            text-align: center;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .contribution-graph {
            margin: 20px 0;
        }

        .month-labels {
            display: flex;
            margin-bottom: 5px;
        }

        .month-label {
            width: auto;
            min-width: 30px;
            text-align: center;
            font-size: 12px;
            color: #8B949E;
            margin-right: 10px;
        }

        .graph-grid {
            display: flex;
            align-items: flex-end;
        }

        .day-labels {
            display: flex;
            flex-direction: column;
            margin-right: 10px;
        }

        .day-label {
            height: 12px;
            margin-bottom: 3px;
            font-size: 12px;
            color: #8B949E;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        .months {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .month {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }

        .month-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .month-name {
            font-size: 14px;
            font-weight: bold;
            color: #8B949E;
        }

        .days {
            display: flex;
            flex-wrap: wrap;
            width: 105px;
            /* 7个方块 * 15px (12px宽度 + 3px间距) */
        }

        .day {
            width: 12px;
            height: 12px;
            margin-right: 3px;
            margin-bottom: 3px;
            border-radius: 2px;
            background-color: #3FB950;
            opacity: 0.2;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .day:hover {
            opacity: 0.8;
        }

        .day.purple {
            background-color: #A855F7;
        }

        .day.red {
            background-color: #EF4444;
        }

        .day.dark-red {
            background-color: #DC2626;
        }

        .legend {
            display: flex;
            align-items: center;
            margin-top: 15px;
            font-size: 12px;
            color: #8B949E;
        }

        .legend-color {
            display: flex;
            margin: 0 10px;
        }

        .legend-item {
            width: 12px;
            height: 12px;
            margin-right: 3px;
            border-radius: 2px;
        }

        .learn-more {
            margin-top: 15px;
            text-align: center;
            font-size: 12px;
            color: #58A6FF;
            cursor: pointer;
        }

        .learn-more:hover {
            text-decoration: underline;
        }

        #explanation {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background-color: #161B22;
            border-radius: 6px;
            font-size: 14px;
        }
        
        /* 月报海报样式 */
        .report-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgb(0, 0, 0);
            justify-content: center;
            align-items: center;
        }
        
        .report-poster {
            /* 海报宽高比：标准海报比例 2:3 */
            width: 500px;
            height: 850px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 0;
            padding: 30px;
            color: white;
            box-shadow: 0 0 30px rgba(88, 166, 255, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .report-poster::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(88, 166, 255, 0.1) 0%, transparent 70%);
            transform: rotate(45deg);
        }
        
        .report-header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            z-index: 1;
        }
        
        .report-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #58A6FF;
            text-align: center;
        }
        
        .report-month {
            font-size: 16px;
            color: #8B949E;
            text-align: center;
        }
        
        .report-content {
            position: relative;
            z-index: 1;
        }
        
        .report-section {
            margin-bottom: 20px;
            background-color: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            box-sizing: border-box;
        }
        
        .report-section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #58A6FF;
        }
        
        .report-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .report-stat-value {
            font-weight: bold;
            color: #3FB950;
        }
        
        .report-highlight {
            background-color: rgba(168, 85, 247, 0.2);
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #A855F7;
        }
        
        .report-highlight h4 {
            font-size: 16px;
            margin-top: 0;
            margin-bottom: 10px;
        }
        
        .report-highlight p {
            font-size: 14px;
            line-height: 1.4;
            margin: 0;
        }
        
        .report-footer {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
            color: #8B949E;
            position: relative;
            z-index: 1;
        }
        
        .close-report-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-size: 16px;
            cursor: pointer;
            z-index: 2;
        }
        
        .close-report-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
    </style>
</head>

<body>
    <!-- 音乐开关 -->
    <div class="music-toggle-container">
        <span class="music-label">BGM</span>
        <label class="toggle-switch">
            <input type="checkbox" id="music-toggle">
            <span class="toggle-slider"></span>
        </label>
    </div>
    
    <!-- 生成月报按钮 -->
    <div class="report-button-container">
        <button class="generate-report-btn" onclick="generateMonthlyReport()">生成月报</button>
    </div>

    <div class="container">
        <h1>堕落记录</h1>
        <div class="current-time" id="current-time"
            style="text-align: center; margin-bottom: 15px; font-size: 16px; color: #8B949E;"></div>
        <div class="streak-info">
            距离最近一次堕落后的坚持不堕落的天数: <span class="streak-count">0</span> 天
        </div>
        <div class="total-count">
            总堕落次数: <span id="total-fallen">0</span> 天
        </div>
        <div class="contribution-graph">
            <div class="graph-grid">
                <div class="months" id="months-container">
                    <!-- 月份和天数方格将通过JavaScript生成 -->
                </div>
            </div>
            <div class="legend">
                <span>Less</span>
                <div class="legend-color">
                    <div class="legend-item" style="background-color: #3FB950; opacity: 0.4;"></div>
                    <div class="legend-item" style="background-color: #A855F7; opacity: 0.6;"></div>
                    <div class="legend-item" style="background-color: #A855F7; opacity: 0.8;"></div>
                    <div class="legend-item" style="background-color: #EF4444; opacity: 0.9;"></div>
                    <div class="legend-item" style="background-color: #DC2626; opacity: 1.0;"></div>
                </div>
                <span>More</span>
            </div>
            <div class="learn-more" onclick="showExplanation()">Learn how we count fallen days</div>
        </div>
        <div id="explanation">
            <h3>堕落记录说明</h3>
            <p>1. 记录时间范围：2026/01/05 至 2026/06/07</p>
            <p>2. 每个方格代表一天</p>
            <p>3. 颜色含义：</p>
            <ul>
                <li>绿色（透明度0.2）：该天没有堕落记录</li>
                <li>紫色（透明度0.4-1.0）：连续堕落天数较少，透明度越高表示连续堕落天数越多</li>
                <li>红色（普通红色到深红色）：连续堕落天数较多，颜色越深表示连续堕落天数越多</li>
            </ul>
            <p>4. 更新方法：在Date.js文件中，将对应日期的0改为1表示该天堕落</p>
            <p>5. 连续堕落计算：如果中间有一天堕落值是0，则连续计数归零</p>
            <p>6. 堕落含义：熬夜、看黄片、导管或挖喷泉、无意义消磨时光......等对学习无意义的行为被计入堕落。</p>
            <p>7. 晚上 23:00 之前没有上床睡觉，一律算作堕落。</p>
            <p>8. 周五、周六晚上 21:30 之前没有上床睡觉，一律算作堕落。</p>
            <p>想回到上一个页面？点击<a href="../demo.html" style="color: #58A6FF;">这里</a></p>
            <!-- <p>
                <iframe loading="lazy" src="//player.bilibili.com/player.html?isOutside=true&aid=1001194128&bvid=BV1tx4y1r7DR&cid=1453717507&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" autoplay="0"></iframe>
                <iframe loading="lazy" src="//player.bilibili.com/player.html?isOutside=true&aid=113882383256083&bvid=BV14rfHYhECG&cid=28051967190&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" autoplay="0"></iframe>
                <iframe loading="lazy" src="//player.bilibili.com/player.html?isOutside=true&aid=114069633765147&bvid=BV1RiPLeMEhS&cid=28587132905&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" autoplay="0"></iframe>
                <iframe loading="lazy" src="//player.bilibili.com/player.html?isOutside=true&aid=1701610686&bvid=BV1fK421s7mR&cid=1462646483&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" autoplay="0"></iframe>
            </p> -->
            <div style="text-align: center; margin: 15px 0;">
                <a href="prevent.html"
                    style="color: #58A6FF; text-decoration: none; font-size: 14px; padding: 5px 10px; border: 1px solid #58A6FF; border-radius: 5px; transition: all 0.3s ease;">查看朋友的考试成绩</a>
            </div>
        </div>
    </div>

    <script src="Date.js"></script>
    <script src="volume.js"></script>
    <script>
        // 获取当前时间
        function getCurrentDate() {
            return new Date();
        }

        // 更新当前时间显示
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('current-time').textContent = timeString;
        }

        // 启动实时时间更新
        function startRealTimeClock() {
            // 立即更新一次
            updateCurrentTime();
            // 每秒更新一次
            setInterval(updateCurrentTime, 1000);
        }

        // 计算连续堕落天数（前缀和）
        function calculateStreaks() {
            const streaks = {};
            let totalFallen = 0;
            let currentStreak = 0;

            // 遍历所有月份
            for (const month in dateData) {
                if (dateData.hasOwnProperty(month)) {
                    streaks[month] = {};
                    const days = dateData[month];

                    // 获取所有日期键并按数字顺序排序
                    const dayKeys = Object.keys(days).sort((a, b) => {
                        return parseInt(a) - parseInt(b);
                    });

                    // 按顺序遍历当月的所有天数
                    dayKeys.forEach(day => {
                        if (days.hasOwnProperty(day)) {
                            const isFallen = days[day];

                            if (isFallen >= 1) {
                                currentStreak++;
                                totalFallen++;
                            } else {
                                currentStreak = 0;
                            }

                            streaks[month][day] = currentStreak;
                        }
                    });
                }
            }

            return { streaks, totalFallen };
        }

        // 计算距离最近一次堕落后的坚持不堕落的天数
        function calculateCurrentStreak() {
            const startDate = new Date('2026-01-05');
            const endDate = new Date('2026-06-07');
            const currentDate = getCurrentDate();

            // 如果当前时间早于开始时间，返回0
            if (currentDate < startDate) {
                return 0;
            }

            // 如果当前时间晚于结束时间，使用结束时间
            const checkDate = currentDate > endDate ? endDate : currentDate;

            // 转换为YYYY-MM-DD格式
            const checkYear = checkDate.getFullYear();
            const checkMonth = String(checkDate.getMonth() + 1).padStart(2, '0');
            const checkDay = String(checkDate.getDate()).padStart(2, '0');

            let streak = 0;
            let foundFallen = false;

            // 从当前日期开始，往前遍历所有日期
            let currentCheckDate = new Date(checkDate);

            while (currentCheckDate >= startDate) {
                const year = currentCheckDate.getFullYear();
                const month = String(currentCheckDate.getMonth() + 1).padStart(2, '0');
                const day = String(currentCheckDate.getDate()).padStart(2, '0');
                const monthStr = `${year}-${month}`;

                // 检查当前日期是否在dateData中
                if (dateData[monthStr] && dateData[monthStr][day] !== undefined) {
                    const isFallen = dateData[monthStr][day];

                    if (isFallen === 1) {
                        // 找到最近一次堕落，停止计数
                        foundFallen = true;
                        break;
                    } else {
                        // 该天未堕落，增加坚持天数
                        streak++;
                    }
                }

                // 往前移动一天
                currentCheckDate.setDate(currentCheckDate.getDate() - 1);
            }

            return streak;
        }

        // 根据连续堕落天数计算颜色和透明度
        function getDayStyle(streak) {
            const style = {
                backgroundColor: '#3FB950',
                opacity: 0.4
            };

            if (streak > 0) {
                if (streak <= 3) {
                    // 紫色阶段
                    style.backgroundColor = '#A855F7';
                    style.opacity = 0.6 + (streak / 3) * 0.4;
                } else if (streak <= 7) {
                    // 红色阶段
                    style.backgroundColor = '#EF4444';
                    style.opacity = 0.8 + ((streak - 3) / 4) * 0.2;
                } else {
                    // 深红色阶段
                    style.backgroundColor = '#DC2626';
                    style.opacity = 1.0;
                }
            }

            return style;
        }

        // 生成日期表格
        function generateGraph() {
            const container = document.getElementById('months-container');
            const { streaks, totalFallen } = calculateStreaks();
            const currentStreak = calculateCurrentStreak();

            // 更新统计信息
            document.querySelector('.streak-count').textContent = currentStreak;
            document.getElementById('total-fallen').textContent = totalFallen;

            // 清空容器
            container.innerHTML = '';

            // 遍历所有月份
            for (const month in dateData) {
                if (dateData.hasOwnProperty(month)) {
                    const monthDiv = document.createElement('div');
                    monthDiv.className = 'month';

                    // 添加月份头部
                    const monthHeaderDiv = document.createElement('div');
                    monthHeaderDiv.className = 'month-header';

                    // 添加月份名称
                    const monthNameDiv = document.createElement('div');
                    monthNameDiv.className = 'month-name';
                    monthNameDiv.textContent = month.split('-')[1] + '月';
                    monthHeaderDiv.appendChild(monthNameDiv);

                    monthDiv.appendChild(monthHeaderDiv);

                    // 添加天数方格
                    const daysDiv = document.createElement('div');
                    daysDiv.className = 'days';

                    const days = dateData[month];
                    const dayStreaks = streaks[month];

                    // 获取所有日期键并按数字顺序排序
                    const dayKeys = Object.keys(days).sort((a, b) => {
                        return parseInt(a) - parseInt(b);
                    });

                    // 遍历当月的所有天数（按顺序）
                    dayKeys.forEach(day => {
                        if (days.hasOwnProperty(day)) {
                            const dayDiv = document.createElement('div');
                            dayDiv.className = 'day';

                            const streak = dayStreaks[day];
                            const style = getDayStyle(streak);

                            dayDiv.style.backgroundColor = style.backgroundColor;
                            dayDiv.style.opacity = style.opacity;

                            // 检测是否是今天的日期
                            const today = new Date();
                            const todayYear = today.getFullYear();
                            const todayMonth = String(today.getMonth() + 1).padStart(2, '0');
                            const todayDay = String(today.getDate()).padStart(2, '0');
                            const todayStr = `${todayYear}-${todayMonth}`;
                            const todayDayStr = todayDay;

                            if (month === todayStr && day === todayDayStr) {
                                // 是今天的日期，添加白色描边
                                dayDiv.style.border = '1px solid white';
                                dayDiv.style.borderRadius = '2px';
                                dayDiv.style.boxSizing = 'border-box';
                            }

                            // 添加悬停提示
                            const dateStr = `${month}-${day}`;
                            const isFallen = days[day] === 1;
                            dayDiv.title = `${dateStr}: ${isFallen ? '堕落' : '未堕落'} (连续${streak}天)`;

                            daysDiv.appendChild(dayDiv);
                        }
                    });

                    monthDiv.appendChild(daysDiv);
                    container.appendChild(monthDiv);
                }
            }
        }

        // 显示说明
        function showExplanation() {
            const explanation = document.getElementById('explanation');
            // 使用更可靠的方式检查元素是否可见
            const isVisible = explanation.offsetHeight > 0 || explanation.offsetWidth > 0;
            explanation.style.display = isVisible ? 'none' : 'block';
        }

        // 页面加载时生成图表和启动实时时间
        window.addEventListener('load', function () {
            generateGraph();
            startRealTimeClock();
        });
    </script>
    
    <!-- 月报模态框 -->
    <div class="report-modal" id="report-modal">
        <div class="report-poster" id="report-poster">
            <button class="close-report-btn" onclick="closeReport()">×</button>
            <div class="report-header">
                <div class="report-title">堕落月报</div>
                <div class="report-month" id="report-month"></div>
            </div>
            <div class="report-content" id="report-content">
                <!-- 月报内容将通过JavaScript动态生成 -->
            </div>
            <div class="report-footer">
                <p>© 2026 ESC. All rights reserved.</p>
                <p>记录成长，拒绝堕落</p>
            </div>
        </div>
    </div>
    
    <script>
        // 生成月报
        function generateMonthlyReport() {
            const now = new Date();
            const currentYear = now.getFullYear();
            const currentMonth = now.getMonth() + 1;
            const currentDay = now.getDate();
            
            // 确定要生成的月份：如果本月过了总天数的二分之一上取整，生成本月的，否则生成上个月的
            let targetYear, targetMonth;
            const daysInMonth = new Date(currentYear, currentMonth, 0).getDate();
            const halfDays = Math.ceil(daysInMonth / 2);
            
            if (currentDay < halfDays) {
                // 本月未过二分之一，生成上个月的
                if (currentMonth === 1) {
                    targetYear = currentYear - 1;
                    targetMonth = 12;
                } else {
                    targetYear = currentYear;
                    targetMonth = currentMonth - 1;
                }
            } else {
                // 本月已过二分之一，生成本月的
                targetYear = currentYear;
                targetMonth = currentMonth;
            }
            
            const targetMonthStr = `${targetYear}-${String(targetMonth).padStart(2, '0')}`;
            
            // 检查目标月份是否有数据
            if (!dateData[targetMonthStr]) {
                alert('该月份暂无数据');
                return;
            }
            
            // 计算该月的统计数据
            const monthData = dateData[targetMonthStr];
            const totalDays = Object.keys(monthData).length;
            let fallenDays = 0;
            let maxStreak = 0;
            let currentStreak = 0;
            
            for (const day in monthData) {
                if (monthData[day] === 1) {
                    fallenDays++;
                    currentStreak++;
                    if (currentStreak > maxStreak) {
                        maxStreak = currentStreak;
                    }
                } else {
                    currentStreak = 0;
                }
            }
            
            const nonFallenDays = totalDays - fallenDays;
            const fallenRate = ((fallenDays / totalDays) * 100).toFixed(1);
            
            // 生成月报内容
            const reportContent = document.getElementById('report-content');
            reportContent.innerHTML = `
                <div class="report-section">
                    <div class="report-section-title">月度概览</div>
                    <div class="report-stat">
                        <span>月份</span>
                        <span class="report-stat-value">${targetYear}年${targetMonth}月</span>
                    </div>
                    <div class="report-stat">
                        <span>总天数</span>
                        <span class="report-stat-value">${totalDays} 天</span>
                    </div>
                    <div class="report-stat">
                        <span>堕落天数</span>
                        <span class="report-stat-value">${fallenDays} 天</span>
                    </div>
                    <div class="report-stat">
                        <span>未堕落天数</span>
                        <span class="report-stat-value">${nonFallenDays} 天</span>
                    </div>
                    <div class="report-stat">
                        <span>堕落率</span>
                        <span class="report-stat-value">${fallenRate}%</span>
                    </div>
                </div>
                
                <div class="report-section">
                    <div class="report-section-title">详细统计</div>
                    <div class="report-stat">
                        <span>最长连续堕落天数</span>
                        <span class="report-stat-value">${maxStreak} 天</span>
                    </div>
                    <div class="report-stat">
                        <span>平均每天状态</span>
                        <span class="report-stat-value">${fallenDays > nonFallenDays ? '堕落' : '自律'}</span>
                    </div>
                </div>
                
                <div class="report-highlight">
                    <h4>月度总结</h4>
                    <p>${generateSummary(fallenDays, nonFallenDays, maxStreak)}</p>
                </div>
                
                <div class="report-section">
                    <div class="report-section-title">月度目标</div>
                    <p>1. 减少堕落天数，争取达到90%以上的自律率</p>
                    <p>2. 打破最长连续堕落记录，保持良好状态</p>
                    <p>3. 培养健康的生活习惯，早睡早起</p>
                </div>
            `;
            
            // 设置月报月份
            document.getElementById('report-month').textContent = `${targetYear}年${targetMonth}月`;
            
            // 显示月报
            document.getElementById('report-modal').style.display = 'flex';
        }
        
        // 生成总结
        function generateSummary(fallenDays, nonFallenDays, maxStreak) {
            if (fallenDays === 0) {
                return '恭喜！本月完全自律，没有任何堕落记录。继续保持这种良好的状态，你正在成为更好的自己！';
            } else if (fallenDays < nonFallenDays) {
                if (maxStreak <= 2) {
                    return '本月整体表现良好，自律天数多于堕落天数。虽然有少量堕落记录，但连续堕落天数较短，说明你能够及时调整自己的状态。继续努力，争取达到更高的自律水平！';
                } else {
                    return '本月自律天数多于堕落天数，但存在较长时间的连续堕落。需要注意避免连续堕落的情况，及时调整自己的状态，保持良好的生活习惯。';
                }
            } else {
                if (maxStreak >= 7) {
                    return '本月堕落天数较多，且存在较长时间的连续堕落。需要高度重视，反思自己的行为，制定有效的改进计划，尽快走出堕落状态，回归自律的生活。';
                } else {
                    return '本月堕落天数较多，需要反思自己的行为。虽然连续堕落天数不是很长，但整体状态不佳。建议制定详细的计划，逐步改善自己的生活习惯。';
                }
            }
        }
        
        // 关闭月报
        function closeReport() {
            document.getElementById('report-modal').style.display = 'none';
        }
        
        // 点击模态框外部关闭
        window.onclick = function(event) {
            const modal = document.getElementById('report-modal');
            if (event.target === modal) {
                closeReport();
            }
        }
    </script>
    
    <!-- 页尾 -->
    <footer
        style="background-color: #0b0e1400; padding: 20px; text-align: center; color: #8B949E; font-size: 12px; margin-top: 40px; width: 100%;">
        <p>© 2026 ESC. All rights reserved.</p>
        <p style="margin-top: 10px;">文化课成绩记录 豫ICP备19000007号-1</p>
    </footer>
</body>

</html>